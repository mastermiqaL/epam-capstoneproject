<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>iMarket</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        nav {
            background-color: #333;
            overflow: hidden;
        }

        nav a {
            float: left;
            display: block;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        nav a:hover {
            background-color: #ddd;
            color: black;
        }

        nav a img {
            height: 20px;
            width: 20px;
            margin-top: -5px;
        }

        form {
            text-align: center;
            margin-top: 10px;
        }

        section {
            text-align: center;
            margin: 20px;
        }

        section h2 {
            color: #333;
        }

        .category-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap; /* Allow categories to wrap to the next row */
        }

        .category {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 23%;
            margin: 10px;
        }

        .category h3 {
            color: #333;
        }

        .product-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap; /* Allow products to wrap to the next row */
        }

        .product {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 23%;
            margin: 10px;
            text-align: center;
        }

        .product img {
            width: 100px;
            height: 100px;
            border-radius: 5px;
        }

        .search-input {
            width: 80%;
            padding: 10px;
            margin-top: 10px;
        }

        /* Add your additional styling here */

    </style>
</head>
<body>

<!-- Navigation bar -->
<nav>
    <div style="float: left;">
        <a th:href="@{/home}">Home</a>
        <a th:href="@{/products}">Products</a>
        <a th:href="@{/categories}">Categories</a>
        <a th:href="@{/about}">About</a>
    </div>

    <div style="float: right;">
        <a th:href="@{/cart}"><img th:src="@{/img/cart.png}" alt="Cart"></a>
        <a th:href="@{/account}"><img th:src="@{/img/account.png}" alt="Account"></a>
    </div>
</nav>

<!-- Search bar -->
<form th:action="@{/search}" method="get">
    <input class="search-input" type="text" th:field="*{search}" placeholder="I am looking for...">
    <button type="submit">Search</button>
</form>
<section>
    <h2>Shop top categories</h2>


    <div class="product-container" th:if="${not #strings.isEmpty(products)}">
        <div class="product" th:each="product : ${products}">
            <!-- Product details here -->
            <p th:text="${product.name}"></p>
            <p th:text="${product.price}"></p>
            <img th:src="@{/img/{imageName}(imageName=${product.imageUrl})}" alt="Product image"/>
        </div>
    </div>
    <!-- Tech category -->
    <div class="category" id="techCategory">
        <h3>Tech</h3>
        <div class="product-container">
            <!-- Iterate over the tech products and dynamically generate HTML -->
            <div class="product" th:each="product : ${techProducts}">
                <!-- Product details here -->
            </div>
        </div>
        <a th:href="@{/tech}">See more</a>
    </div>

<!--    &lt;!&ndash; Books category &ndash;&gt;-->
<!--    <div class="category" id="booksCategory" th:if="${booksProducts}">-->
<!--        <h3>Books</h3>-->
<!--        <div class="product-container">-->
<!--            &lt;!&ndash; Iterate over the books products and dynamically generate HTML &ndash;&gt;-->
<!--            <div class="product" th:each="product : ${booksProducts}">-->
<!--                &lt;!&ndash; Product details here &ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--        <a th:href="@{/books}">See more</a>-->
<!--    </div>-->

<!--    &lt;!&ndash; Plants category &ndash;&gt;-->
<!--    <div class="category" id="plantsCategory" th:if="${plantsProducts}">-->
<!--        <h3>Plants</h3>-->
<!--        <div class="product-container">-->
<!--            &lt;!&ndash; Iterate over the plants products and dynamically generate HTML &ndash;&gt;-->
<!--            <div class="product" th:each="product : ${plantsProducts}">-->
<!--                &lt;!&ndash; Product details here &ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--        <a th:href="@{/plants}">See more</a>-->
<!--    </div>-->


</section>

<script th:inline="javascript">
    var categories = [
        { name: 'Tech', products: /*[[${techProducts}]]*/ [] },
<!--        { name: 'Books', products: /*[[${booksProducts}]]*/ [] },-->
<!--        { name: 'Plants', products: /*[[${plantsProducts}]]*/ [] }-->
        // Add other category data as needed
    ];

    categories.forEach(function(category) {
        var categoryDiv = document.getElementById(category.name.toLowerCase() + 'Category');
        var productContainer = document.createElement('div');
        productContainer.className = 'product-container';

        // Check if the category has products before iterating
        if (category.products && category.products.length > 0) {
            // Iterate over the products and dynamically generate HTML
            category.products.forEach(function(product) {
                var productDiv = document.createElement('div');
                productDiv.className = 'product';

                var productLink = document.createElement('a');
                productLink.href = '/product/' + product.id;

                var productImage = document.createElement('img');
                productImage.src = '/img/' + product.image;
                productImage.alt = 'Product image';

                var productName = document.createElement('p');
                productName.innerText = product.name;

                var productPrice = document.createElement('p');
                productPrice.innerText = product.price;

                productLink.appendChild(productImage);
                productDiv.appendChild(productLink);
                productDiv.appendChild(productName);
                productDiv.appendChild(productPrice);
                productContainer.appendChild(productDiv);
            });
        }

        categoryDiv.appendChild(productContainer);
    });



</script>
</body>
</html>